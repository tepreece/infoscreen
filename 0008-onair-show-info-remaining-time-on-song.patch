From fbea672e3ac8dcfa03a0e1d65b5ff067eee16b7e Mon Sep 17 00:00:00 2001
From: Thomas <thomas@tuomas.co.uk>
Date: Tue, 18 Dec 2012 03:35:36 +0000
Subject: [PATCH 8/9] onair show info, remaining time on song

---
 config.py     |    5 +++++
 info.json     |    8 ++++----
 infoscreen.py |   12 +++++++++++-
 3 files changed, 20 insertions(+), 5 deletions(-)

diff --git a/config.py b/config.py
index 5fb036f..669c2e4 100644
--- a/config.py
+++ b/config.py
@@ -249,6 +249,11 @@ MESSAGE_TEXT_SIZE = 52
 
 SHOW_TRACKINFO = True
 TRACKINFO_COLOR = (41, 255, 41)
+TRACKINFO_REMAINS_COLOR = (200, 200, 200)
+
+SHOW_ONAIR = True
+SHOW_COLOR = (41, 255, 211)
+ONAIR_COLOR = (150, 255, 211)
 
 # 
 # END
diff --git a/info.json b/info.json
index fb677da..149a891 100644
--- a/info.json
+++ b/info.json
@@ -4,10 +4,10 @@
 	{"color":"44 0 252", "text":"Current Show: thom"}
 	],
 	"track":{
-	"start":"1355799000",
-	"end":"1355802000",
-	"artist":"The Smiths",
-	"title":"London"
+	"start":"1355800000",
+	"end":"1355801900",
+	"artist":"Portugal. The Man",
+	"title":"It's Complicated Being A Wizard"
 	},
 	"show":"George & Thomas - URN After Dark",
 	"onair":"2"
diff --git a/infoscreen.py b/infoscreen.py
index 61601a6..d17213c 100644
--- a/infoscreen.py
+++ b/infoscreen.py
@@ -319,6 +319,12 @@ while True:
 				currentmessage = 0
 		render_text(screen, messagefont, info["messages"][currentmessage]["text"], MESSAGE_X, MESSAGE_Y, info["messages"][currentmessage]["color"], MESSAGE_ALIGN)
 
+	# draw show/onair info
+	if SHOW_ONAIR:
+		onair = "Live from Studio " + info["onair"]	
+		render_text(screen, messagefont, info["show"], WIDTH-10, HEIGHT-200, SHOW_COLOR, RIGHT)
+		render_text(screen, messagefont, onair, WIDTH-10, HEIGHT-160, ONAIR_COLOR, RIGHT)
+
 	#draw remaining time on song
 	if SHOW_TRACKINFO:
 		start = int(info["track"]["start"])
@@ -326,11 +332,15 @@ while True:
 		if (time.time() < end):
 			length = end - start
 			played = time.time() - start
+			remains = end - time.time()
+			m, s = divmod(remains, 60)
+			remainingstr = "%d:%02d" % (m, s)
 			progress = played / float(length)
 			trackinfostr = "now playing: " + info["track"]["artist"] + " - " + info["track"]["title"]
-			render_text(screen, messagefont, trackinfostr, 10, HEIGHT-74, TRACKINFO_COLOR, LEFT)
 			pygame.draw.rect(screen, (255,0,0), pygame.Rect(0,HEIGHT-30,WIDTH,30))
 			pygame.draw.rect(screen, (0,255,0), pygame.Rect(0,HEIGHT-30,WIDTH*progress,30))
+			render_text(screen, messagefont, trackinfostr, 10, HEIGHT-74, TRACKINFO_COLOR, LEFT)
+			render_text(screen, messagefont, remainingstr, WIDTH-10, HEIGHT-30, TRACKINFO_REMAINS_COLOR, RIGHT)
 
 	# blit the dead air image after doing everything above
 	# dead air image could be partially transparent
-- 
1.7.9.5

